local toolchainlib = require("../lune_packages/core")
local fs = require("@lune/fs")

return function(version)
	local exit_code = toolchainlib("1axen/blink", "bins/blink", { "bins/blink/tests/input.blink" })
	assert(exit_code == 0, `shouldnt error`)

	local client_signature = `\n-- File generated by Blink v{version}`
	assert(fs.readFile("bins/blink/tests/output/client.luau"):find(client_signature, 1, true), `invalid client output`)

	local server_signature = `\n-- File generated by Blink v{version}`
	assert(fs.readFile("bins/blink/tests/output/server.luau"):find(server_signature, 1, true), `invalid server output`)
end
